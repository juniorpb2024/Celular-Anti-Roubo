<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Segurança do Celular</title>
</head>
<body>
    <h1>Verifique a Segurança do Seu Celular</h1>
    <form id="security-form">
        <label for="cpf">Digite seu CPF:</label>
        <input type="text" id="cpf" name="cpf" required>
        <button type="submit">Iniciar Avaliação</button>
    </form>

    <div id="questions" style="display:none;">
        <h2>Responda às perguntas abaixo:</h2>
        <div id="question-container"></div>
        <button id="submit-answers" style="display:none;">Finalizar</button>
    </div>

    <div id="result" style="display:none;">
        <h2>Resultado</h2>
        <p id="result-message"></p>
    </div>

    <script>
        const questions = [
            "Você utiliza senha ou biometria para desbloquear o celular?",
            "Seu celular está configurado para apagar dados em caso de tentativas de desbloqueio inválidas?",
            "Você realiza backups regulares dos seus dados?",
            "Seu celular possui um antivírus instalado?",
            "Seu sistema operacional está atualizado?"
        ];

        const form = document.getElementById('security-form');
        const questionsDiv = document.getElementById('questions');
        const questionContainer = document.getElementById('question-container');
        const resultDiv = document.getElementById('result');
        const resultMessage = document.getElementById('result-message');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const cpf = document.getElementById('cpf').value;
            localStorage.setItem('cpf', cpf);
            displayQuestions();
        });

        function displayQuestions() {
            form.style.display = 'none';
            questionsDiv.style.display = 'block';
            questions.forEach((q, index) => {
                const questionHTML = `
                    <div>
                        <p>${q}</p>
                        <input type="radio" name="question-${index}" value="yes" required> Sim
                        <input type="radio" name="question-${index}" value="no"> Não
                    </div>
                `;
                questionContainer.innerHTML += questionHTML;
            });
            document.getElementById('submit-answers').style.display = 'block';
        }

        document.getElementById('submit-answers').addEventListener('click', () => {
            const answers = [];
            questions.forEach((_, index) => {
                const answer = document.querySelector(`input[name="question-${index}"]:checked`);
                if (answer) {
                    answers.push(answer.value);
                }
            });

            const unsafe = answers.filter(a => a === 'no').length;
            if (unsafe > 2) {
                resultMessage.textContent = 'Seu celular está desprotegido. Recomendamos melhorar sua segurança.';
            } else {
                resultMessage.textContent = 'Parabéns! Seu celular está protegido.';
            }
            saveResult(localStorage.getItem('cpf'), unsafe);
            questionsDiv.style.display = 'none';
            resultDiv.style.display = 'block';
        });

        function saveResult(cpf, unsafeCount) {
            fetch('http://localhost:3000/save-result', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ cpf, unsafeCount })
            });
        }
    </script>
</body>
</html>
